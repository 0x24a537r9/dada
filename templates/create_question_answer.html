{% extends 'base.html' %}

{% block url %}http://www.open-dada.com/question-answer/create/{% endblock %}

{% block title %}Create Question &amp; Answer{% endblock %}

{% block head %}
{{ super() }}
<meta property="og:title" content="Create a &quot;Question &amp; Answer&quot; Poem!"/>
<meta property="og:description" content="Submit your own profound question or answer to be randomly paired with questions/answers from others in an exercise of global collaborative poetry!"/>
<style>
  #content {
    min-height: 500px;
  }
</style>
{% endblock %}

{% block content %}
{{ super() }}
<div id="instructions-container">
  <div>
    Submit your own <span class="accent">profound</span> question and/or
    <span class="accent">unrelated</span> answer. The more poignant and specific, the better.<br>
    <br>
    <label for="question-textbox">Q:</label>
    <input id="question-textbox" type="text" maxlength="64" placeholder="What is life?"></input>
    <br>
    <label for="answer-textbox">A:</label>
    <input id="answer-textbox" type="text" maxlength="64" placeholder="Scrambled eggs nailed to a wall."></input>
    <br>
    <label for="author-textbox">By:</label>
    <input id="author-textbox" type="text" maxlength="32" placeholder="Your name..."></input>
    <div id="instructions-buttons-container">
      <button class="submit-button"><img src="/static/envelope.svg" alt="Submit"/></button>
    </div>
  </div>
</div>
{% endblock %}

{% block footer %}
{{ super() }}
<a id="top-poems-link" href="/{{ poem_type }}/top/">
  <img id="top-hat" src="/static/top-hat.svg" alt="Top hat"/>Top poems
</a>
{% endblock %}

{% block footer_script %}
{{ super() }}
<script>
  $(function() {  
    $('#author-textbox').val(localStorage.getItem('author') || '');
    $(document).keydown(function(e) { if(e.which == 13) submit(); });
    $('.submit-button').click(submit);
  });

  function submit() {
    var hasUncreativeEntry = false;
    $('input[type="text"]').each(function(i, entry) {
      var $entry = $(entry);
      if ($entry.val().replace(/[^a-zA-Z]/g, '').toLowerCase() ==
          $entry.attr('placeholder').replace(/[^a-zA-Z]/g, '').toLowerCase()) {
        hasUncreativeEntry = true;
        return false;
      }
    });
    if (hasUncreativeEntry) {
      showBannerMessage('Really?');
      showBannerMessage('C\'mon. Be creative.');
      return;
    }

    createEntries(['question', 'answer'], $('#question-textbox, #answer-textbox'),
                  $('#author-textbox'));
  }
</script>
{% endblock %}